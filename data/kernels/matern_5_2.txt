function cov_kernel,x,theta0,theta1
;; Covariance kernel used by likelihood evaluation, simulated series
;; and plot_tim_ser

;; create array identical to x argument
f = x
Argument = - abs(x) * theta1 * 2.23607D
bigNeg = where(Argument LT -15D,complement=smallNeg)
if bigNeg NE [-1] then f[bigNeg] = 0D
if smallNeg NE [-1] then begin
   f[smallNeg] = theta0^2 * (1D + 2.23607D * abs(x[smallNeg]) * theta1 + $
   	       	 	    1.666667D * x[smallNeg]^2 * theta1^2) * exp(Argument[smallNeg])
endif

return,f

end
